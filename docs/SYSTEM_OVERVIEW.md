# iNLighT Rental Manager - Rendszer Áttekintés

## Magas Szintű Architektúra

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           iNLighT Rental Manager                             │
│                                   (PWA)                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                        PUBLIKUS RÉTEG                                 │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │   │
│  │  │   Home      │  │  Termékek   │  │   About     │  │  Contact    │  │   │
│  │  │   (Hero)    │  │  (Katalógus)│  │   Us        │  │   Form      │  │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                    │                                         │
│                              🔐 LOGIN                                        │
│                                    │                                         │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                        BELSŐ RÉTEG (Autentikált)                      │   │
│  │                                                                        │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐  │   │
│  │  │                         DASHBOARD                                │  │   │
│  │  │   • Aktív bérlések        • Lejáró bérlések (figyelmeztetés)    │  │   │
│  │  │   • Mai visszavárások     • Készlet összefoglaló                │  │   │
│  │  └─────────────────────────────────────────────────────────────────┘  │   │
│  │                                                                        │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌───────────┐  │   │
│  │  │   M1:        │  │   M2:        │  │   M3:        │  │   M4:     │  │   │
│  │  │   RENTAL     │  │   SUBRENTAL  │  │   REPORTS    │  │  CATALOG  │  │   │
│  │  │              │  │              │  │              │  │   ADMIN   │  │   │
│  │  │ • Új bérlés  │  │ • Új bérlés  │  │ • Lekérdezés │  │           │  │   │
│  │  │ • Visszavét  │  │ • Visszavét  │  │ • Export     │  │ • Termék+ │  │   │
│  │  │ • Készlet    │  │ • Nyilvántart│  │ • Heti rip.  │  │ • Kateg.  │  │   │
│  │  │ • Naptár     │  │ • Naptár     │  │ • Leltár     │  │ • Import  │  │   │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └───────────┘  │   │
│  │                                                                        │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              SUPABASE BACKEND                                │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │  PostgreSQL  │  │     Auth     │  │   Storage    │  │    Edge      │     │
│  │  (Adatbázis) │  │  (Bejelentk.)│  │   (Képek)    │  │  Functions   │     │
│  │              │  │              │  │              │  │              │     │
│  │ • products   │  │ • email/pw   │  │ • product/   │  │ • reminder   │     │
│  │ • rentals    │  │ • roles      │  │ • documents/ │  │ • weekly_rep │     │
│  │ • clients    │  │              │  │              │  │ • pdf_gen    │     │
│  │ • categories │  │              │  │              │  │              │     │
│  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Bérlési Folyamat (Rental & Subrental)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            BÉRLÉSI ÉLETCIKLUS                                │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌─────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐
    │  DRAFT  │ ───► │ ACTIVE  │ ───► │ OVERDUE │ ───► │RETURNED │
    │         │      │         │      │         │      │         │
    │ Vázlat  │      │  Aktív  │      │ Lejárt  │      │ Lezárt  │
    └─────────┘      └─────────┘      └─────────┘      └─────────┘
         │                │                │                │
         │                │                │                │
         ▼                ▼                ▼                ▼
    ┌─────────┐      ┌─────────┐      ┌─────────┐      ┌─────────┐
    │Termékek │      │Készlet  │      │ Push    │      │Készlet  │
    │kiválasz.│      │csökken  │      │értesítés│      │visszatér│
    │Dátum,   │      │(Rental) │      │         │      │Állapot  │
    │Kliens   │      │         │      │         │      │rögzítés │
    └─────────┘      └─────────┘      └─────────┘      └─────────┘
                                                              │
                                                              ▼
                                                       ┌─────────────┐
                                                       │   Sérült?   │
                                                       │   Hiányos?  │
                                                       └─────────────┘
                                                        /           \
                                                       ▼             ▼
                                                   ┌──────┐     ┌──────┐
                                                   │  OK  │     │NOTED │
                                                   └──────┘     └──────┘
```

## Termék Struktúra (Alkatrészekkel)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          TERMÉK HIERARCHIA                                   │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌───────────────────────────────────────────────────────────────┐
    │                    FŐ TERMÉK                                   │
    │                (pl. Arri M40 HMI)                              │
    │                                                                │
    │  • name_en / name_hu                                          │
    │  • daily_rate: €45/day                                        │
    │  • own_stock: 3 db                                            │
    │  • rental_type: 'rental'                                      │
    │  • is_public: true                                            │
    └───────────────────────────────────────────────────────────────┘
                                │
                 ┌──────────────┼──────────────┐
                 ▼              ▼              ▼
    ┌──────────────────┐ ┌──────────────────┐ ┌──────────────────┐
    │ KÖTELEZŐ ALKATR. │ │ OPCIONÁLIS ALKAT.│ │ KÉSZLETEZETT     │
    │ (is_required)    │ │                  │ │ (has_own_stock)  │
    │                  │ │                  │ │                  │
    │ pl. Ballast      │ │ pl. Barn doors   │ │ pl. Spare bulb   │
    │ pl. Head cable   │ │ pl. Scrim set    │ │ own_stock: 5     │
    └──────────────────┘ └──────────────────┘ └──────────────────┘
           │                    │                    │
           └────────────────────┼────────────────────┘
                                │
                                ▼
                 ┌───────────────────────────────┐
                 │    BÉRLÉS CHECKBOX-OK         │
                 │                               │
                 │  ☑ Ballast (kötelező)         │
                 │  ☑ Head cable (kötelező)      │
                 │  ☐ Barn doors                 │
                 │  ☐ Scrim set                  │
                 │  ☐ Spare bulb (2 db elérhető) │
                 └───────────────────────────────┘
```

## Készlet Kalkuláció (Jövőbeli Elérhetőség)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                     JÖVŐBELI KÉSZLET SZÁMÍTÁS                                │
└─────────────────────────────────────────────────────────────────────────────┘

Példa: Arri M40 HMI (own_stock = 5 db)

       Jan 15     Jan 20     Jan 22     Jan 25     Jan 30
         │          │          │          │          │
TIMELINE ├──────────┼──────────┼──────────┼──────────┼─────────►
         │          │          │          │          │
         │          │          │          │          │
    ┌────▼────┐     │     ┌────▼────┐     │          │
    │ Bérlés  │     │     │ Lekérd. │     │          │
    │ #1      │     │     │ dátuma  │     │          │
    │ 2 db    │─────┼─────│         │     │          │
    │ kint    │  visszajön│         │     │          │
    └─────────┘     │     └─────────┘     │          │
                    │                      │          │
              ┌─────▼─────┐          ┌────▼────┐     │
              │ Bérlés #2 │          │ Bérlés  │     │
              │ 1 db kint │──────────│ #3      │─────┤ visszajön
              └───────────┘          │ 1 db    │     │
                                     │ kint    │     │
                                     └─────────┘     │

SZÁMÍTÁS Jan 22-re:
  Alap készlet:           5 db
  - Jelenleg kint (#2):   1 db
  - Jelenleg kint (#3):   1 db
  + Visszajön Jan 20 (#1): 2 db
  ─────────────────────────────
  = Elérhető Jan 22-én:   5 db  ✓
```

## Heti Riport Workflow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          HETI RIPORT AUTOMATIZMUS                            │
└─────────────────────────────────────────────────────────────────────────────┘

   Péntek 00:00                                           Péntek 18:00
        │                                                       │
        ▼                                                       ▼
   ┌─────────┐                                            ┌─────────────┐
   │ Előző   │                                            │ Supabase    │
   │ péntek  │ ◄───────── IDŐSZAK ──────────────────────► │ Edge        │
   │         │                                            │ Function    │
   └─────────┘                                            └──────┬──────┘
                                                                 │
                                                                 ▼
                                                       ┌─────────────────┐
                                                       │  RIPORT TARTALMA │
                                                       ├─────────────────┤
                                                       │ ✓ Kiadott       │
                                                       │   termékek      │
                                                       │                 │
                                                       │ ✓ Visszaérkezett│
                                                       │   termékek      │
                                                       │                 │
                                                       │ ✓ Készlet       │
                                                       │   összesítő     │
                                                       │                 │
                                                       │ ✓ Lejáró        │
                                                       │   bérlések      │
                                                       └────────┬────────┘
                                                                │
                                        ┌───────────────────────┼───────────────────────┐
                                        ▼                       ▼                       ▼
                                  ┌───────────┐           ┌───────────┐           ┌───────────┐
                                  │   PUSH    │           │   EMAIL   │           │  M3 modul │
                                  │ Értesítés │           │  (opció)  │           │ letöltés  │
                                  └───────────┘           └───────────┘           └───────────┘
```

## Export Formátumok

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            EXPORT LEHETŐSÉGEK                                │
└─────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────┐
                              │   M3 MODUL   │
                              │   Reports    │
                              └──────┬───────┘
                                     │
         ┌───────────┬───────────────┼───────────────┬───────────┐
         ▼           ▼               ▼               ▼           ▼
    ┌─────────┐ ┌─────────┐    ┌─────────┐    ┌─────────┐ ┌─────────┐
    │  Excel  │ │   PDF   │    │   Word  │    │ Google  │ │  iCloud │
    │  .xlsx  │ │   .pdf  │    │  .docx  │    │ Sheets  │ │  Drive  │
    └─────────┘ └─────────┘    └─────────┘    └─────────┘ └─────────┘
         │           │               │               │           │
         │           │               │               │           │
         ▼           ▼               ▼               ▼           ▼
    ┌─────────┐ ┌─────────┐    ┌─────────┐    ┌─────────────────────┐
    │ Helyi   │ │ Helyi   │    │ Helyi   │    │   OAuth 2.0         │
    │letöltés │ │letöltés │    │letöltés │    │   autentikáció      │
    └─────────┘ └─────────┘    └─────────┘    └─────────────────────┘


    ┌─────────────────────────────────────────────────────────────────┐
    │                    ÁTADÁS-ÁTVÉTELI BIZONYLAT                     │
    ├─────────────────────────────────────────────────────────────────┤
    │                                                                  │
    │  BIZONYLAT SORSZÁM: R-20250128-0001         DÁTUM: 2025.01.28   │
    │  ─────────────────────────────────────────────────────────────  │
    │                                                                  │
    │  BÉRLŐ:                          BÉRBEADÓ:                       │
    │  XY Productions Kft.             iNLighT Kft.                    │
    │  Budapest, Film u. 1.            rental@inlight.hu               │
    │  Adószám: 12345678-2-42          +36 20 334 8823                 │
    │                                                                  │
    │  PROJEKT: "Feature Film 2025"                                    │
    │  IDŐSZAK: 2025.01.28 - 2025.02.05                               │
    │  ─────────────────────────────────────────────────────────────  │
    │                                                                  │
    │  TERMÉKEK:                                                       │
    │  ┌──────────────────────────────────────────────────────────┐   │
    │  │ #   Termék                                          Db   │   │
    │  ├──────────────────────────────────────────────────────────┤   │
    │  │ 1   Arri M40 HMI                                     2   │   │
    │  │     + Ballast, Head cable                                │   │
    │  │ 2   Aputure 600D Pro                                 3   │   │
    │  │ 3   12x12 Frame                                      1   │   │
    │  │ 4   8x8 Butterfly silk                               2   │   │
    │  └──────────────────────────────────────────────────────────┘   │
    │                                                                  │
    │  ─────────────────────────────────────────────────────────────  │
    │                                                                  │
    │  VÉGÖSSZEG: €2,450.00                                           │
    │  (Egyedi árképzés alapján - nem kalkulált!)                     │
    │                                                                  │
    │  ─────────────────────────────────────────────────────────────  │
    │                                                                  │
    │  Átadó aláírás: _____________    Átvevő aláírás: ____________   │
    │                                                                  │
    │  [QR KÓD - opcionális]                                          │
    │                                                                  │
    └─────────────────────────────────────────────────────────────────┘
```
